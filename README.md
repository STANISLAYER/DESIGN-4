# Лабораторная работа 4  
## Тема: Базовое взаимодействие с памятью через переменные

### Концепты
* Память: стек (временная) и хип (динамическая)
* Переменная как абстракция ячейки памяти
* Операции чтения и записи значений
* Значение и объект
* Адрес памяти
* Ссылка на объект
* Типы данных
* Тип-значение и ссылочный тип
* Выражение

В данной работе анализируются небольшие фрагменты кода на C#. Для каждого фрагмента я объясняю:

1. Какие инструкции выполняются и в каком порядке.  
2. Сколько ячеек выделяется во временной памяти (стеке).  
3. Какие значения записываются в эти ячейки на каждом шаге и к концу программы.  
4. Сколько объектов создается в динамической памяти (хипе).  
5. Что находится в переменных после выполнения фрагмента.  
6. Что будет напечатано в консоль.

Ниже приведен разбор всех примеров.

---

## Пример 1

```csharp
int a = 5;
int b = 6;
a = b;
b = 7;
Console.WriteLine(a);
```

### 1. Выполняемые инструкции и порядок

1. `int a = 5;`  
   Создается переменная `a` типа `int`, в нее записывается значение 5.

2. `int b = 6;`  
   Создается переменная `b` типа `int`, в нее записывается значение 6.

3. `a = b;`  
   Из переменной `b` читается значение 6 и копируется в переменную `a`.  
   Старое значение `a` (5) затирается.

4. `b = 7;`  
   В переменную `b` записывается новое значение 7.  
   Старое значение `b` (6) затирается.

5. `Console.WriteLine(a);`  
   Из переменной `a` читается значение 6 и выводится в консоль.

### 2. Ячейки временной памяти (стек)

В стеке выделяется две ячейки:
* одна для переменной `a`
* одна для переменной `b`

Итого: 2 ячейки.

### 3. Значения в ячейках

По шагам:
* После `int a = 5;`: `a = 5`  
* После `int b = 6;`: `a = 5`, `b = 6`  
* После `a = b;`: `a = 6`, `b = 6`  
* После `b = 7;`: `a = 6`, `b = 7`

К моменту вывода:
* `a = 6`  
* `b = 7`

### 4. Объекты в динамической памяти

Тип `int` является типом-значением, он хранится в стеке.  
Объектов в хипе не создается.

Итого: 0 объектов в хипе.

### 5. Состояние переменных в конце

* `a = 6`  
* `b = 7`

### 6. Вывод в консоль

Выводится значение `a`, то есть:

```text
6
```

---

## Пример 2

```csharp
int a = 5;
int b = a + 6;
a = 7;
Console.WriteLine(b);
```

### 1. Выполняемые инструкции и порядок

1. `int a = 5;`  
   Создается переменная `a` типа `int`, записывается значение 5.

2. `int b = a + 6;`  
   Читается значение `a` (5), вычисляется выражение `5 + 6 = 11`.  
   Создается переменная `b` типа `int`, в нее записывается значение 11.

3. `a = 7;`  
   В переменную `a` записывается новое значение 7.

4. `Console.WriteLine(b);`  
   Из `b` читается значение 11 и выводится в консоль.

### 2. Ячейки временной памяти (стек)

Выделяется две ячейки:
* для `a`
* для `b`

Итого: 2 ячейки.

### 3. Значения в ячейках

По шагам:
* После `int a = 5;`: `a = 5`  
* После `int b = a + 6;`: `a = 5`, `b = 11`  
* После `a = 7;`: `a = 7`, `b = 11`

К моменту вывода:
* `a = 7`  
* `b = 11`

### 4. Объекты в динамической памяти

Тип `int` является типом-значением, хранится в стеке.  
Объектов в хипе не создается.

Итого: 0 объектов в хипе.

### 5. Состояние переменных в конце

* `a = 7`  
* `b = 11`

### 6. Вывод в консоль

Выводится значение `b`, то есть:

```text
11
```

---

## Пример 3

```csharp
string a = "1";
string b = a;
a = "2";
Console.WriteLine(a);
Console.WriteLine(b);
```

### 1. Выполняемые инструкции и порядок

1. `string a = "1";`  
   Переменная `a` создается в стеке как ссылочный тип.  
   В динамической памяти (хип) создается объект строки `"1"`.  
   В `a` записывается ссылка (адрес) этого строкового объекта.

2. `string b = a;`  
   Создается переменная `b` в стеке.  
   В `b` копируется ссылка, хранящаяся в `a`.  
   В результате и `a`, и `b` указывают на один и тот же объект строки `"1"` в хипе.

3. `a = "2";`  
   В хипе создается новый объект строки `"2"`.  
   В переменную `a` записывается ссылка на новый объект `"2"`.  
   Переменная `b` по-прежнему указывает на старый объект `"1"`.

4. `Console.WriteLine(a);`  
   Читается ссылка из `a`, находящийся по адресу объект `"2"` выводится в консоль.

5. `Console.WriteLine(b);`  
   Читается ссылка из `b`, находящийся по адресу объект `"1"` выводится в консоль.

### 2. Ячейки временной памяти (стек)

В стеке выделяется две ячейки:
* одна для ссылки `a`
* одна для ссылки `b`

Итого: 2 ячейки.

### 3. Значения в ячейках

Важно понимать, что в стеке хранятся ссылки, а сами строки живут в хипе.

По шагам:
* После `string a = "1";`  
  - В хипе создан объект `"1"`.  
  - В стеке: `a` содержит ссылку на `"1"`.

* После `string b = a;`  
  - В стеке:  
    `a` содержит ссылку на `"1"`  
    `b` содержит такую же ссылку на `"1"`.

* После `a = "2";`  
  - В хипе создан новый объект `"2"`.  
  - В стеке:  
    `a` содержит ссылку на `"2"`  
    `b` содержит ссылку на `"1"`.

### 4. Объекты в динамической памяти

Создаются два объекта строки:
* объект `"1"`
* объект `"2"`

Итого: 2 объекта в хипе.

### 5. Состояние переменных в конце

* `a` содержит ссылку на строку `"2"`  
* `b` содержит ссылку на строку `"1"`

### 6. Вывод в консоль

Сначала печатается значение `a`, затем `b`:

```text
2
1
```

---

## Пример 4

```csharp
string a = 5;
```


Данный код не выполняется, потому что не проходит стадию компиляции.  
Компилятор видит попытку присвоить целое число `5` переменной типа `string` и выдает ошибку.


## Пример 5

```csharp
int a = 5;
int a = 6;
```

Этот код также не компилируется.  
В одной и той же области видимости переменная `a` объявляется два раза.  
Компилятор выдает ошибку о повторном объявлении локальной переменной с одним и тем же именем.
